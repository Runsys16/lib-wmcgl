#!/bin/bash
#----------------------------------------------------------------------------------------------------
STR0="ed makefile src/depend.py src/build_makefile src/build_include src/makefile.base"
STR1="src/lib/*.h"
STR2="src/lib/*.cpp"
#----------------------------------------------------------------------------------------------------
function get_window_id() {
	WINDOW_ID=""
	for n in $*
	do
		FILENAME=$(basename $n)
		#echo Recherche de $FILENAME $n
		WINDOW_ID=$(wmctrl -l | grep "lib-wmcgl"| grep "gedit" | grep "$FILENAME (" | cut -f1 -d" ")
		if [ "$WINDOW_ID" != "" ]
		then
			break
		fi
	done
	
    echo $WINDOW_ID
}

#----------------------------------------------------------------------------------------------------
function get_workspace()	{
	N=$(wmctrl -d | cut -d' ' -f8 | cut -d',' -f1)
	echo $N
}

#----------------------------------------------------------------------------------------------------
function wait_id()	{
	ID=""
	while [ "$ID" == "" ]
	do
		ID=$(get_window_id $*)
	done
}

#----------------------------------------------------------------------------------------------------
function run_edit()	{
	ID=$(get_window_id $*)
	if [ "$ID" == "" ]
	then
		edition $*
	fi
}

#----------------------------------------------------------------------------------------------------
#----------------------------------------------------------------------------------------------------

OUVERT=$(wmctrl -l | grep "lib-wmcgl" | grep "gedit" | wc -l)

if [ "$OUVERT" == "3" ]
then
	echo Les fichiers sont deja edite ....
	exit 0
fi

#----------------------------------------------------------------------------------------------------
run_edit $STR0
wait_id $STR0
wmctrl -i -r $(get_window_id $STR0) -e 0,1000,0,900,1150

#----------------------------------------------------------------------------------------------------
run_edit $STR1
wait_id $STR1
wmctrl -i -r $(get_window_id $STR1) -e 0,1920,0,900,1150

#----------------------------------------------------------------------------------------------------
run_edit $STR2
wait_id $STR2
wmctrl -i -r $(get_window_id $STR2) -e 0,2920,0,900,1150



